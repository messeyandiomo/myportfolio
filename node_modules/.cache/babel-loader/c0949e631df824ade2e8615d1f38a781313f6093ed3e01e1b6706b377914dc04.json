{"ast":null,"code":"// Copyright 2012 Timothy J Fontaine <tjfontaine@gmail.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE\n\nvar dgram = require('dgram'),\n  EventEmitter = require('events').EventEmitter,\n  net = require('net'),\n  util = require('util');\nvar is_absolute = exports.is_absolute = function (f) {\n  return f && /\\.$/.test(f);\n};\nvar ensure_absolute = exports.ensure_absolute = function (f) {\n  if (!is_absolute(f)) return f += '.';\n  return f;\n};\nvar CNAME = require('native-dns-packet').consts.NAME_TO_QTYPE.CNAME;\nvar Lookup = exports.Lookup = function (store, zone, question, cb) {\n  if (!(this instanceof Lookup)) return new Lookup(store, zone, question, cb);\n  this.store = store;\n  this.zone = zone;\n  this.cb = cb;\n  this.question = question;\n  this.results = [];\n  this.wildcard = undefined;\n  this.name = ensure_absolute(question.name);\n  this.store.get(this.zone, this.name, this.lookup.bind(this));\n};\nLookup.prototype.send = function (err) {\n  this.cb(err, this.results);\n};\nLookup.prototype.lookup = function (err, results) {\n  var type,\n    ret,\n    name,\n    self = this;\n  if (err) return this.send(err);\n  if (!results) {\n    if (!this.wildcard) this.wildcard = this.question.name;\n    if (this.wildcard.toLowerCase() == this.zone.toLowerCase()) return this.send();\n    name = this.wildcard = this.wildcard.split('.').splice(1).join('.');\n\n    // 'com.'.split('.').splice(1) will return empty string, we're at the end\n    if (!this.wildcard) return this.send();\n    name = '*.' + name;\n  } else if (results[this.question.type]) {\n    type = this.question.type;\n    ret = results;\n  } else if (results[CNAME]) {\n    type = CNAME;\n    ret = results;\n    this.name = name = results[CNAME][0].data;\n  }\n  if (ret) {\n    ret = ret[type];\n    ret.forEach(function (r) {\n      var rr, k;\n      if (self.wildcard && /^\\*/.test(r.name)) {\n        rr = {};\n        for (k in r) {\n          rr[k] = r[k];\n        }\n        rr.name = self.name;\n      } else {\n        rr = r;\n      }\n      self.results.push(rr);\n    });\n  }\n  if (name) this.store.get(this.zone, ensure_absolute(name), this.lookup.bind(this));else this.send();\n};","map":{"version":3,"names":["dgram","require","EventEmitter","net","util","is_absolute","exports","f","test","ensure_absolute","CNAME","consts","NAME_TO_QTYPE","Lookup","store","zone","question","cb","results","wildcard","undefined","name","get","lookup","bind","prototype","send","err","type","ret","self","toLowerCase","split","splice","join","data","forEach","r","rr","k","push"],"sources":["/home/bilal/ReactLabs/myportfolio/src/node_modules/native-dns-cache/lookup.js"],"sourcesContent":["// Copyright 2012 Timothy J Fontaine <tjfontaine@gmail.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE\n\nvar dgram = require('dgram'),\n    EventEmitter = require('events').EventEmitter,\n    net = require('net'),\n    util = require('util');\n\nvar is_absolute = exports.is_absolute = function (f) {\n  return f && /\\.$/.test(f);\n};\n\nvar ensure_absolute = exports.ensure_absolute = function (f) {\n  if (!is_absolute(f))\n    return f += '.';\n  return f;\n};\n\nvar CNAME = require('native-dns-packet').consts.NAME_TO_QTYPE.CNAME;\n\nvar Lookup = exports.Lookup = function (store, zone, question, cb) {\n  if (!(this instanceof Lookup))\n    return new Lookup(store, zone, question, cb);\n\n  this.store = store;\n  this.zone = zone;\n  this.cb = cb;\n  this.question = question;\n  this.results = [];\n  this.wildcard = undefined;\n\n  this.name = ensure_absolute(question.name);\n\n  this.store.get(this.zone, this.name, this.lookup.bind(this));\n};\n\nLookup.prototype.send = function (err) {\n  this.cb(err, this.results);\n};\n\nLookup.prototype.lookup = function (err, results) {\n  var type, ret, name, self = this;\n\n  if (err)\n    return this.send(err);\n\n  if (!results) {\n    if (!this.wildcard)\n      this.wildcard = this.question.name;\n\n    if (this.wildcard.toLowerCase() == this.zone.toLowerCase())\n      return this.send();\n\n    name = this.wildcard = this.wildcard.split('.').splice(1).join('.');\n\n    // 'com.'.split('.').splice(1) will return empty string, we're at the end\n    if (!this.wildcard)\n      return this.send();\n\n    name = '*.' + name;\n  } else if (results[this.question.type]) {\n    type = this.question.type;\n    ret = results;\n  } else if (results[CNAME]) {\n    type = CNAME;\n    ret = results;\n    this.name = name = results[CNAME][0].data\n  }\n\n  if (ret) {\n    ret = ret[type];\n    ret.forEach(function (r) {\n      var rr, k;\n\n      if (self.wildcard && /^\\*/.test(r.name)) {\n        rr = {};\n        for (k in r) {\n          rr[k] = r[k];\n        }\n        rr.name = self.name;\n      } else {\n        rr = r;\n      }\n\n      self.results.push(rr);\n    });\n  }\n\n  if (name)\n    this.store.get(this.zone, ensure_absolute(name), this.lookup.bind(this));\n  else\n    this.send();\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}